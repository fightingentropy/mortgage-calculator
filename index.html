<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>UK Property Calculator</title>
    <meta name="description" content="Buy vs Rent and Buy-to-Let investment calculator for the UK">
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <header class="app-header">
      <h1>UK Property Calculator</h1>
      <p class="subtitle">Buy vs Rent and Buy-to-Let (investment)</p>
      <div class="mode-toggle" role="tablist" aria-label="Mode selector">
        <button type="button" role="tab" aria-selected="true" id="modeOwnerBtn" class="mode active" data-mode="owner">Buy vs Rent</button>
        <button type="button" role="tab" aria-selected="false" id="modeBtlBtn" class="mode" data-mode="btl">Buy-to-Let</button>
      </div>
    </header>

    <main class="container">
      <section class="card inputs">
        <h2>Inputs</h2>
        <form id="inputs-form" autocomplete="off">
          <div class="section">
            <h3>Property & Purchase</h3>
            <div class="grid two">
              <label class="field">
                <span>Purchase price (£)</span>
                <input id="purchasePrice" type="number" min="0" step="1000" value="500000">
              </label>
              <label class="field">
                <span>Deposit type</span>
                <select id="depositType">
                  <option value="amount">£ amount</option>
                  <option value="percent" selected>% of price</option>
                </select>
              </label>
              <label class="field" id="depositValueField">
                <span>Deposit</span>
                <input id="depositValue" type="number" min="0" step="1000" value="10">
              </label>
              <label class="field">
                <span>Other purchase fees (£)</span>
                <input id="otherPurchaseCosts" type="number" min="0" step="50" value="0">
              </label>
              <label class="field">
                <span>Product fee (£)</span>
                <input id="productFee" type="number" min="0" step="50" value="0">
              </label>
              <label class="field">
                <span>Product fee treatment</span>
                <select id="productFeeTreatment">
                  <option value="upfront">Pay upfront</option>
                  <option value="add_to_loan" selected>Add to loan</option>
                </select>
              </label>
            </div>
          </div>

          <div class="section">
            <h3>Mortgage</h3>
            <div class="grid two">
              <label class="field">
                <span>Mortgage type</span>
                <select id="repaymentType">
                  <option value="repayment" selected>Repayment</option>
                  <option value="interest_only">Interest-only</option>
                </select>
              </label>
              <label class="field">
                <span>APR (%)</span>
                <input id="interestRatePercent" type="number" min="0" step="0.01" value="4">
              </label>
              <label class="field">
                <span>Term (years)</span>
                <input id="termYears" type="number" min="1" max="40" step="1" value="25">
              </label>
            </div>
          </div>

          <div class="section">
            <h3>Economics & Exit</h3>
            <div class="grid two">
              <label class="field">
                <span>House-price growth (% p.a.)</span>
                <input id="hpiGrowth" type="number" step="0.1" value="3">
              </label>
              <label class="field">
                <span>CPI inflation (% p.a.)</span>
                <input id="cpiPercent" type="number" step="0.1" value="2">
              </label>
              <label class="field">
                <span>Discount rate (% p.a.)</span>
                <input id="discountRate" type="number" step="0.1" value="4">
              </label>
              <label class="field">
                <span>Sell at end of term?</span>
                <select id="sellAtEnd">
                  <option value="yes" selected>Yes</option>
                  <option value="no">No</option>
                </select>
              </label>
              <label class="field">
                <span>Selling agent fee (%)</span>
                <input id="agentPercent" type="number" step="0.1" value="1.5">
              </label>
              <label class="field">
                <span>VAT on agent fee (%)</span>
                <input id="agentVatPercent" type="number" step="0.1" value="20">
              </label>
              <label class="field">
                <span>Legal fees on sale (£)</span>
                <input id="saleLegal" type="number" step="50" value="1000">
              </label>
            </div>
            <div class="capex">
              <div class="capex-header">
                <h4>Capex schedule (optional)</h4>
                <button type="button" id="addCapex">Add row</button>
              </div>
              <div id="capexRows" class="capex-rows"></div>
            </div>
          </div>

          <div class="section">
            <h3>Taxes</h3>
            <div class="grid two">
              <label class="field">
                <span>Buyer type (SDLT)</span>
                <select id="buyerType">
                  <option value="ftb">First-time buyer</option>
                  <option value="standard">Standard</option>
                  <option value="additional" selected>Additional property</option>
                </select>
              </label>
              <label class="field">
                <span>Surcharge refund within 3 years?</span>
                <select id="surchargeRefund">
                  <option value="no" selected>No</option>
                  <option value="yes">Yes</option>
                </select>
              </label>
              <label class="field">
                <span>CGT rate on sale</span>
                <select id="cgtRate">
                  <option value="18">18%</option>
                  <option value="24" selected>24%</option>
                  <option value="blended">Blended</option>
                </select>
              </label>
              <label class="field">
                <span>CGT annual allowance (£)</span>
                <input id="cgtAllowance" type="number" step="100" value="3000">
              </label>
              <label class="field">
                <span>PRR main residence (last 9 months deemed occupied)</span>
                <select id="prrToggle">
                  <option value="no" selected>No</option>
                  <option value="yes">Yes</option>
                </select>
              </label>
            </div>
          </div>

          <div class="section owner-only">
            <h3>Owner-occupier (Buy vs Rent)</h3>
            <div class="grid two">
              <label class="field">
                <span>Current rent (£/mo)</span>
                <input id="currentRent" type="number" step="50" value="2000">
              </label>
              <label class="field">
                <span>Rent inflation (% p.a.)</span>
                <input id="rentInflation" type="number" step="0.1" value="3">
              </label>
              <label class="field">
                <span>Maintenance (% of value per year)</span>
                <input id="ownerMaintenancePctOfValue" type="number" step="0.1" value="1">
              </label>
              <label class="field">
                <span>Service charge (£/yr)</span>
                <input id="ownerService" type="number" step="50" value="2300">
              </label>
              <label class="field">
                <span>Buildings insurance (£/yr)</span>
                <input id="ownerInsurance" type="number" step="50" value="300">
              </label>
              <label class="field">
                <span>Ground rent (£/yr)</span>
                <input id="ownerGroundRent" type="number" step="50" value="0">
              </label>
            </div>
          </div>

          <div class="section btl-only" hidden>
            <h3>Buy-to-Let (Investment)</h3>
            <div class="grid two">
              <label class="field">
                <span>Market rent (£/mo)</span>
                <input id="btlRentMonthly" type="number" step="50" value="2000">
              </label>
              <label class="field">
                <span>Voids (%)</span>
                <input id="btlVoidsPct" type="number" step="0.5" value="5">
              </label>
              <label class="field">
                <span>Management fee (% of collected rent)</span>
                <input id="btlMgmtPct" type="number" step="0.5" value="12">
              </label>
              <label class="field">
                <span>Compliance & safety (£/yr)</span>
                <input id="btlCompliance" type="number" step="50" value="250">
              </label>
              <label class="field">
                <span>Landlord tax band</span>
                <select id="landlordTaxBand">
                  <option value="20">20%</option>
                  <option value="40">40%</option>
                  <option value="45" selected>45%</option>
                </select>
              </label>
              <label class="field">
                <span>Section 24 (finance cost credit at 20%)</span>
                <select id="section24">
                  <option value="on" selected>ON</option>
                  <option value="off">OFF</option>
                </select>
              </label>
            </div>
          </div>

          <div class="actions">
            <button type="button" class="secondary" id="resetBtn">Reset defaults</button>
            <span class="spacer"></span>
            <button type="button" id="downloadCsv">Download CSV</button>
            <button type="button" id="printPdf">Print summary</button>
          </div>
        </form>
      </section>

      <section class="card results">
        <h2>Summary</h2>
        <div class="highlights grid-3">
          <div class="kpi">
            <div class="kpi-label">Nominal IRR</div>
            <div class="kpi-value" id="kpiIrr">0.00%</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Real IRR (deflated by CPI)</div>
            <div class="kpi-value" id="kpiRealIrr">0.00%</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">NPV</div>
            <div class="kpi-value" id="kpiNpv">£0</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Total cash in</div>
            <div class="kpi-value" id="kpiCashIn">£0</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Net proceeds / Equity at end</div>
            <div class="kpi-value" id="kpiNetProceeds">£0</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Payback year</div>
            <div class="kpi-value" id="kpiPayback">—</div>
          </div>
        </div>

        <div class="mode-output owner-only">
          <h3>Buy vs Rent outputs</h3>
          <div class="table">
            <div class="row header"><span>Metric</span><span>Value</span></div>
            <div class="row"><span>Year owning becomes cheaper than renting</span><span id="ownerCheaperYear">—</span></div>
            <div class="row"><span>Breakeven rent (Year 1, £/mo)</span><span id="ownerBreakevenRent">£0</span></div>
          </div>
        </div>

        <div class="mode-output btl-only" hidden>
          <h3>BTL outputs</h3>
          <div class="table">
            <div class="row header"><span>Metric</span><span>Value</span></div>
            <div class="row"><span>Year cashflow turns positive</span><span id="btlPositiveYear">—</span></div>
          </div>
        </div>

        <div class="charts">
          <h3>Charts</h3>
          <div class="grid two">
            <div>
              <canvas id="cashflowChart" height="160"></canvas>
            </div>
            <div>
              <canvas id="valueDebtChart" height="160"></canvas>
            </div>
          </div>
        </div>

        <div class="tables">
          <h3>Tables</h3>
          <div class="grid two">
            <div>
              <h4>Amortisation</h4>
              <div class="table" id="amortTable"></div>
            </div>
            <div class="btl-only" id="btlTableWrap" hidden>
              <h4>BTL P&L</h4>
              <div class="table" id="btlTable"></div>
            </div>
          </div>
        </div>

        <div class="sensitivity">
          <h3>Sensitivity</h3>
          <div class="grid two">
            <div>
              <h4>Price growth × Rent growth</h4>
              <div id="heatmapGrowth" class="heatmap"></div>
            </div>
            <div>
              <h4>Interest rate × Deposit</h4>
              <div id="heatmapFinance" class="heatmap"></div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <p>Estimates only. Not tax advice. England/NI/Wales SDLT and rUK income tax.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
  </body>
</html>


